# Sub-Band System - Godgame

## Overview

Large aggregate entities (armies, guilds, villages, mercenary companies) can temporarily split off smaller **sub-bands** to perform specialized tasks while the main group continues its primary mission. Sub-bands operate semi-independently with specific objectives (scouting, foraging, resupply, diplomacy, raiding) and maintain communication with the parent group. Upon completion, sub-bands can rejoin the parent or operate autonomously if circumstances change.

**Core Concepts:**
- **Parent Band**: The main aggregate entity (army, guild, village)
- **Sub-Band**: Smaller detachment with specific mission
- **Task Assignment**: Sub-bands have objectives distinct from parent
- **Autonomy Level**: How independently sub-bands can make decisions
- **Rejoining Mechanics**: Conditions for sub-band reintegration
- **Resource Sharing**: Sub-bands may carry supplies back to parent

---

## Sub-Band Types

### 1. Scout Party

**Purpose**: Reconnaissance ahead of main force

**Composition**:
- Size: 3-8 members
- Required: Scout (skill 60+), Tracker (skill 50+)
- Optional: Cartographer, Ranger, Hunter

**Mission Parameters**:
- Range: 5-20 km ahead of parent
- Duration: 1-5 days
- Objective: Map terrain, identify threats, locate resources
- Return condition: Report findings every 24 hours or when threat detected

**Risk Factors**:
- Enemy patrols: 20-40% encounter chance
- Getting lost: 5-15% (mitigated by high Navigation skill)
- Wildlife attacks: 10-25%
- Capture: 8-15% if detected

**Success Criteria**:
- Map 80%+ of designated area
- Identify all major threats within range
- Return with intel within deadline

**Rewards (Parent Band)**:
- +30% movement speed (forewarned of obstacles)
- +25% ambush avoidance (threats pre-identified)
- +15% morale (reduced uncertainty)

---

### 2. Foraging Party

**Purpose**: Gather food and resources from surrounding area

**Composition**:
- Size: 5-15 members
- Required: Forager (skill 50+), Herbalist or Hunter (skill 40+)
- Optional: Cook, Alchemist (for rare herbs)

**Mission Parameters**:
- Range: 2-10 km from parent
- Duration: 4-12 hours
- Objective: Gather food (50-200 rations), herbs, wood, water
- Return condition: Inventory full or daylight ending

**Risk Factors**:
- Poisonous plants: 10% (mitigated by Herbalist skill 60+)
- Animal attacks: 15-30%
- Bandit ambush: 5-12%
- Getting separated: 8-18%

**Success Criteria**:
- Gather ≥75% of target supplies
- No fatalities
- Return before nightfall

**Rewards (Parent Band)**:
- Food: 50-200 rations (+3-15 days autonomy)
- Herbs: 10-40 units (healing, alchemy)
- Wood: 20-80 units (campfires, construction)
- Morale: +5-10 (well-fed troops)

---

### 3. Resupply Caravan

**Purpose**: Transport supplies from depot to main force

**Composition**:
- Size: 8-25 members
- Required: Quartermaster (skill 50+), 5-10 Guards (combat 40+), 2-5 Porters
- Optional: Merchant (negotiate better prices), Healer

**Mission Parameters**:
- Range: 10-100 km (to nearest settlement/depot)
- Duration: 2-10 days (round trip)
- Objective: Purchase/retrieve supplies, return to parent
- Cargo: Food (500-2,000 rations), arrows (1,000-5,000), armor repairs, medical supplies

**Risk Factors**:
- Bandit raids: 25-40% (heavily loaded = tempting target)
- Toll demands: 15-30% (feudal lords, brigands)
- Desertion: 5-12% (guards abscond with valuables)
- Delay: 20-35% (weather, broken carts, sick animals)

**Success Criteria**:
- Deliver ≥80% of supplies to parent
- Maintain schedule within 20% variance
- No loss of guards to combat

**Rewards (Parent Band)**:
- Resupply: +10-30 days operational capacity
- Morale: +10-15 (secure supply line established)
- Equipment: Replace damaged armor/weapons

---

### 4. Raiding Party

**Purpose**: Attack enemy supply lines, villages, or weak points

**Composition**:
- Size: 10-30 members
- Required: Raid Leader (tactics 60+, ruthlessness 50+), 8-25 Warriors (combat 50+)
- Optional: Thief (lockpicking), Archer (ranged support)

**Mission Parameters**:
- Range: 5-25 km (strike enemy rear areas)
- Duration: 1-3 days
- Objective: Destroy supplies, capture prisoners, steal valuables, cause chaos
- Return condition: Mission complete or resistance too strong

**Risk Factors**:
- Enemy retaliation: 30-50% (counterattack on parent band)
- Heavy casualties: 20-40% (raiding is dangerous)
- Capture: 10-20% (torture, ransom, execution)
- Loot temptation: 15-25% (raiders prioritize loot over objectives)

**Success Criteria**:
- Destroy ≥500 enemy rations or 1,000 arrows
- Capture ≥3 prisoners (intel value)
- Casualties <30%

**Rewards (Parent Band)**:
- Enemy morale: -15-25 (fear, supply disruption)
- Intel: Enemy strength, positions, weaknesses
- Loot: 200-800 gold, weapons, food
- Morale (raiders): +10-20 (victory, spoils)

**Consequences**:
- Enemy retaliatory raid: 30-50% chance within 3 days
- Diplomatic penalty: -20 to -40 (if civilians harmed)
- Increased enemy vigilance: +15% detection chance for future raids

---

### 5. Diplomatic Envoy

**Purpose**: Negotiate with other factions, deliver messages, arrange alliances

**Composition**:
- Size: 3-10 members
- Required: Diplomat (charisma 70+, persuasion 60+), 2-5 Guards (protection)
- Optional: Scribe (record agreements), Translator (foreign languages)

**Mission Parameters**:
- Range: 10-200 km (to foreign settlements)
- Duration: 3-20 days (travel + negotiation time)
- Objective: Negotiate treaty, deliver ultimatum, request aid, arrange trade
- Return condition: Agreement reached or rejected

**Risk Factors**:
- Ambush en route: 10-25%
- Hostile reception: 15-30% (diplomatic failure)
- Assassination attempt: 5-10% (if relations extremely poor)
- Delay: 25-40% (ceremonial protocols, bureaucracy)

**Success Criteria**:
- Complete diplomatic objective (treaty, alliance, trade agreement)
- Return with signed documents
- No diplomatic incidents

**Rewards (Parent Band)**:
- Alliance: +1 military ally (reinforcements possible)
- Trade agreement: -20% supply costs, +15% gold income
- Intelligence: Enemy troop movements, political shifts
- Reputation: +10-25 (diplomatic success)

**Failure Consequences**:
- Relations: -30 to -60 with target faction
- War declaration: 5-15% chance if ultimatum rejected
- Morale: -10 (diplomatic humiliation)

---

### 6. Rear Guard

**Purpose**: Protect main force retreat, delay pursuers

**Composition**:
- Size: 15-50 members
- Required: Rear Guard Commander (tactics 70+, courage 80+), 12-45 Heavy Infantry
- Optional: Archers (harass pursuers), Cavalry (skirmish and withdraw)

**Mission Parameters**:
- Range: 1-5 km behind retreating parent
- Duration: 4-24 hours (until parent reaches safety)
- Objective: Delay enemy pursuit, inflict casualties, buy time
- Return condition: Parent reaches defensible position or enemy gives up pursuit

**Risk Factors**:
- Heavy casualties: 40-70% (fighting retreat is costly)
- Total annihilation: 15-30% (if enemy commits overwhelming force)
- Desertion: 20-35% (fear of death in hopeless situation)
- Capture: 10-20% (exhaustion, surrounded)

**Success Criteria**:
- Delay enemy ≥4 hours
- Parent band escapes with <10% casualties
- Rear guard casualties <60%

**Rewards (Parent Band)**:
- Survival: Main force escapes destruction
- Morale: +15-30 (grateful for sacrifice)
- Time: 4-12 hours to fortify new position

**Consequences (Rear Guard)**:
- Casualty rate: 50-70% expected
- Captured survivors: 10-20% (ransom, torture, execution)
- Glory: +40 reputation (heroic sacrifice)

---

## Sub-Band Formation

### Decision to Split

Parent band leaders decide to form sub-bands based on:

**Need Assessment**:
```
Scout Party Need = (Unexplored Territory %) + (Enemy Proximity) - (Map Quality)

If need > 60%: High priority, form scout party
If need 30-60%: Medium priority, consider scouting
If need < 30%: Low priority, continue without scouts
```

**Example:**
Army entering unknown forest:
- Unexplored: 90%
- Enemy proximity: 40% (rumors of enemy patrols)
- Map quality: 20% (crude sketches only)
- **Need**: 90 + 40 - 20 = **110** → **High priority**
- Decision: Form scout party (6 members, 3 day mission)

---

### Member Selection

Sub-bands are formed by selecting members with appropriate skills:

**Selection Criteria:**
1. **Primary Skill Match**: Member's top skill matches sub-band requirement
2. **Availability**: Not critical to parent band operations
3. **Loyalty**: ≥60 loyalty (won't desert with supplies)
4. **Health**: ≥70% HP (fit for mission)
5. **Willingness**: Volunteerism or conscription

**Voluntary vs Conscripted:**
- **Voluntary**: +10 morale, +15% success chance, -5% desertion
- **Conscripted**: -15 morale, -10% success chance, +15% desertion

**Skill Requirements Example (Scout Party):**
```
Required:
- 1× Scout (Navigation 60+, Stealth 50+)
- 1× Tracker (Tracking 50+, Survival 40+)

Preferred:
- 1× Ranger (Archery 50+, Stealth 40+)
- 1× Cartographer (Mapmaking 60+)

Minimum Total: 3 members
Optimal Total: 5-6 members
```

---

### Resource Allocation

Parent band allocates resources to sub-band:

**Scout Party (6 members, 3 days):**
- Food: 18 rations (6 members × 3 days)
- Water: 36 liters
- Equipment: Bows (3), swords (3), light armor (6), rope (20m), maps (1), compass (1)
- Gold: 50 (bribes, emergency purchases)
- **Total weight**: 85 kg (14 kg per member)

**Resupply Caravan (15 members, 8 days round trip):**
- Food: 120 rations (for travel)
- Gold: 5,000 (to purchase supplies at depot)
- Carts: 3 (to transport supplies back)
- Guards: 10 (to protect caravan)
- Draft animals: 6 oxen (pull carts)
- **Cargo capacity**: 2,400 kg (800 kg per cart)

---

## Sub-Band Autonomy

Sub-bands operate with varying levels of independence:

### Autonomy Levels

**1. Tethered (Low Autonomy)**
- Sub-band must stay within 5 km of parent
- Report every 6 hours (messenger or magic)
- Cannot deviate from mission without approval
- Parent can recall instantly
- **Use**: High-value sub-bands (diplomatic envoys, resupply caravans)

**2. Semi-Autonomous (Medium Autonomy)**
- Sub-band can operate within 20 km of parent
- Report every 24 hours
- Can make tactical decisions within mission scope
- Parent can recall with 6-hour delay
- **Use**: Scout parties, foraging parties, raiding parties

**3. Independent (High Autonomy)**
- Sub-band can operate anywhere within region (100+ km)
- Report every 3-7 days
- Full tactical and strategic freedom
- Parent can only request return (not command)
- **Use**: Long-range reconnaissance, diplomatic missions to distant nations

---

### Communication Methods

**Messenger Riders**:
- Speed: 50 km/day
- Range: 100 km
- Reliability: 85% (weather, bandits)
- Cost: 1 rider per message

**Signal Fires**:
- Speed: Instant (line of sight)
- Range: 10-20 km (depends on terrain)
- Reliability: 95% (weather affects visibility)
- Messages: Pre-arranged codes (enemy sighted, mission complete, need help)

**Magical Communication (TL 7+)**:
- Speed: Instant
- Range: Unlimited (if both parties have paired crystals)
- Reliability: 98% (mana interference, crystal damage)
- Cost: 500 gold per crystal pair

**Homing Pigeons**:
- Speed: 80 km/day
- Range: 200 km
- Reliability: 75% (hawks, storms, getting lost)
- Cost: 5 gold per pigeon

---

## Rejoining Mechanics

### Rendezvous Planning

Sub-bands rejoin parent at designated rendezvous points:

**Fixed Rendezvous**:
- Pre-arranged location (e.g., "Oak Grove, 15 km north of Rivertown")
- Pre-arranged time (e.g., "3 days from now, sunset")
- Parent waits up to 12 hours if sub-band delayed
- If sub-band doesn't arrive, assumed lost/captured

**Mobile Rendezvous**:
- Parent leaves trail markers (broken branches, cairns)
- Sub-band tracks parent using Tracking skill
- Success chance: `60% + (Tracker Skill - 50) + Terrain Bonus`
- Failure: Sub-band lost, must navigate to last known position

**Example:**
Scout party (Tracker skill 75) following army through plains:
- Base success: 60%
- Skill bonus: 75 - 50 = +25%
- Terrain bonus: Plains (+15%, clear trails)
- **Total**: 60 + 25 + 15 = **100%** (automatic success)

Same tracker in mountains:
- Base: 60%
- Skill: +25%
- Terrain: Mountains (-10%, difficult tracking)
- **Total**: 60 + 25 - 10 = **75%** (likely success, but not guaranteed)

---

### Reintegration Process

When sub-band rejoins parent:

**1. Report (Intelligence Transfer)**
- Scout party: Map updates, enemy positions, terrain hazards
- Foraging party: Resource yields, dangerous areas
- Resupply caravan: Depot status, prices, rumors
- Diplomatic envoy: Treaty terms, faction attitudes, political shifts

**2. Resource Transfer**
- Foraging party: +120 rations, +30 herbs
- Resupply caravan: +1,800 rations, +3,000 arrows, +50 armor repairs
- Raiding party: +450 gold, +12 weapons, +3 prisoners

**3. Personnel Reintegration**
- Casualties: 15% (5 of 30 raiders killed)
- Wounded: 25% (need medical attention)
- Deserters: 3% (1 member fled with loot)
- Promotions: Successful sub-band leaders gain +10 reputation

**4. Morale Impact**
- Successful mission: +10-20 morale (parent band)
- Failed mission: -10-20 morale
- Heavy casualties: -15-30 morale
- Great success: +25-40 morale (massive loot, critical intel)

---

### Failure to Rejoin

If sub-band doesn't return:

**Search Party (Optional)**:
- Size: 5-12 members
- Duration: 2-5 days
- Success chance: 40-70% (depends on how long sub-band missing)
- Risks: Search party also gets lost (10-15%)

**Abandonment (Harsh)**:
- Parent continues without sub-band
- Sub-band considered KIA or deserted
- Morale penalty: -15-25 (abandoned comrades)
- Future sub-bands: -20% volunteer rate (fear of abandonment)

**Wait Period (Compassionate)**:
- Parent waits up to 3 extra days
- If sub-band returns during wait: +30 morale (loyalty to comrades)
- If sub-band doesn't return: -10 morale (time wasted)
- Enemy opportunity: 25% chance of attack while waiting

---

## Sub-Band Independence

Some sub-bands become fully independent:

### Conditions for Independence

**Voluntary Separation:**
- Sub-band completes mission, decides not to rejoin
- Reasons: Found better opportunity, ideological split, fear of parent's fate
- Loyalty check: `IF Loyalty < 50 AND (Loot > 500 OR Threat > 70) THEN 30% chance of independence`

**Forced Separation:**
- Parent band destroyed/captured
- Sub-band too far away to help
- Sub-band becomes orphaned, must survive independently

**Mutual Agreement:**
- Parent and sub-band agree to separate
- Common: Diplomatic envoy stays in foreign court permanently
- Common: Raiding party becomes independent mercenary company

---

### Independent Sub-Band Evolution

**Raiding Party → Mercenary Company:**
- Original: 25 raiders from parent army
- After independence: Recruit to 50-80 members
- New identity: "The Iron Hawks" mercenary company
- Leadership: Former raid leader becomes captain
- Relations with parent: Allied (50-70), will accept contracts from former parent

**Scout Party → Explorer Guild:**
- Original: 6 scouts from merchant guild
- After independence: Establish cartography business
- New identity: "Pathfinder's Guild"
- Services: Sell maps, guide caravans, train scouts
- Relations with parent: Trade partners (60-80)

**Foraging Party → Homesteaders:**
- Original: 12 foragers from village
- After independence: Settle in fertile valley discovered during mission
- New identity: "Greenhollow Village"
- Population: Grows from 12 to 50-100 over years
- Relations with parent: Tributary (40-60), pays taxes to parent village

---

## Sub-Band Composition Optimization

### Skill Synergies

Effective sub-bands have complementary skills:

**Optimal Scout Party (6 members):**
1. Scout (Navigation 80, Stealth 70): Leader, pathfinding
2. Tracker (Tracking 75, Survival 60): Follow enemy trails
3. Ranger (Archery 70, Stealth 65): Combat specialist
4. Cartographer (Mapmaking 70, Geography 60): Create maps
5. Hunter (Hunting 60, Stealth 55): Food procurement
6. Herbalist (Herbalism 50, Medicine 45): Heal injuries, identify plants

**Synergy Bonuses:**
- Scout + Tracker: +20% threat detection (combined expertise)
- Ranger + Hunter: +30% food acquisition (efficient hunting)
- Herbalist + Hunter: +25% medicine availability (forage while hunting)

---

### Size Optimization

Sub-band size affects success probability:

```
Success Modifier = Base + Size Bonus - Unwieldiness Penalty

Size Bonus:
- 1-3 members: -10% (too small, vulnerable)
- 4-8 members: +10% (optimal for most tasks)
- 9-15 members: +5% (good for combat missions)
- 16-30 members: 0% (neutral, large operations)
- 31-50 members: -10% (unwieldy, harder to coordinate)
- 51+ members: -20% (not a sub-band, more like army detachment)
```

**Example (Scout Party):**
- 3 members: -10% (too few, if one injured mission fails)
- 6 members: +10% (optimal, enough specialists, still stealthy)
- 12 members: 0% (too many, harder to hide)

**Example (Resupply Caravan):**
- 5 members: -10% (too few guards, bandit target)
- 15 members: +5% (good balance, enough guards, manageable)
- 40 members: -10% (too many, slow, expensive)

---

## Strategic Considerations

### Risk vs Reward

Forming sub-bands has trade-offs:

**Benefits:**
- Specialized task completion (+30-50% efficiency vs parent doing it)
- Parallel operations (parent continues main mission)
- Intel gathering (reduced uncertainty)
- Resource acquisition (extend operational range)

**Costs:**
- Split forces (parent weaker by sub-band size)
- Coordination overhead (messengers, planning)
- Risk of loss (sub-bands may be destroyed/captured)
- Morale impact (fear of separation, dangerous missions)

**Break-Even Analysis:**
```
Form sub-band IF:
(Expected Benefit × Success Probability) > (Cost + Risk Penalty)

Example (Scout Party):
- Expected benefit: +25% movement speed, +20% ambush avoidance = 100 value
- Success probability: 75%
- Cost: 6 members, 18 rations, 3 days = 30 value
- Risk penalty: 15% chance of total loss = 15 value

Decision:
(100 × 0.75) > (30 + 15)
75 > 45
**Form scout party** ✓
```

---

### Parent Band Vulnerability

Sub-bands weaken parent temporarily:

**Army (500 soldiers) sends Scout Party (6), Foraging Party (12), Raiding Party (25):**
- Parent strength: 500 - 43 = **457 soldiers** (-8.6%)
- If attacked: -8.6% combat effectiveness
- Duration: 2-5 days (until sub-bands return)

**Mitigation:**
- Send sub-bands only when safe (not during active combat)
- Maintain minimum force threshold (never go below 400 soldiers)
- Recall sub-bands early if threat detected

---

## Combat Example: Sub-Band Coordination

**Setup:**
- **Parent**: Baron Aldric's Army (800 soldiers, marching to siege enemy castle)
- **Enemy**: Count Valen's Garrison (600 soldiers, defending castle 50 km ahead)

**Day 1: Sub-Band Formation**

Baron Aldric forms three sub-bands:

**Scout Party (6 members, 3 day mission):**
- Mission: Scout enemy castle defenses, garrison strength
- Composition: 2 scouts, 2 rangers, 1 tracker, 1 cartographer
- Autonomy: Semi-autonomous, report every 24 hours

**Foraging Party (15 members, 2 day mission):**
- Mission: Gather food from surrounding farms
- Composition: 8 foragers, 5 guards, 2 hunters
- Autonomy: Tethered, stay within 5 km

**Raiding Party (30 members, 4 day mission):**
- Mission: Burn enemy supply depot 20 km west of castle
- Composition: 1 raid leader, 25 warriors, 4 archers
- Autonomy: Semi-autonomous, report every 24 hours

**Parent Band:**
- Remaining: 800 - 51 = **749 soldiers**
- Activity: Continue march at normal pace (15 km/day)

---

**Day 2: Scout Party Intel**

Scout party reaches enemy castle (30 km ahead of parent):
- Garrison: ~550 soldiers (lower than expected, 50 out on patrol)
- Defenses: Stone walls (8m high), 4 towers, moat (dry)
- Weak point: North gate (old wood, vulnerable to fire)
- Supply: Large granary inside (2 months food)

**Message (Signal Fire Code):** "Castle sighted, garrison 550, north gate weak"

Baron Aldric adjusts plan: Focus siege on north gate, prepare fire arrows

---

**Day 3: Raiding Party Success**

Raiding party reaches enemy supply depot:
- Guards: 15 soldiers
- Supplies: 3,000 rations, 2,000 arrows, 500 gold
- Attack: Nighttime raid, overwhelm guards
- Casualties: 4 raiders killed, 8 wounded
- Result: Depot burned, 500 gold looted, 200 rations captured (rest destroyed)

**Impact:**
- Enemy morale: -20 (supply loss, fear)
- Enemy operational capacity: -30 days
- Baron's morale: +15 (successful raid, weakened enemy)

---

**Day 4: Foraging Party Returns**

Foraging party rejoins parent with:
- Food: 180 rations (enough for 1 extra day for full army)
- Herbs: 40 units (medicine)
- Intel: Local peasants sympathetic to Baron (will not resist foragers)

---

**Day 5: All Sub-Bands Rejoin**

**Scout Party:**
- Detailed map of castle and surrounding area
- Enemy patrol routes (avoid/ambush opportunities)
- Weak point confirmed (north gate)
- Casualties: 0

**Raiding Party:**
- 500 gold looted
- 200 rations captured
- Casualties: 4 killed, 8 wounded (26% casualty rate, acceptable)

**Total Sub-Band Impact:**
- Intel: +40% siege success probability (know defenses, weak points)
- Enemy weakened: -20 morale, -30 days supplies
- Parent resources: +180 rations, +500 gold, +40 herbs
- Parent morale: +20 (successful operations, well-informed)

**Day 6-10: Siege**

Baron Aldric besieges castle with full knowledge of defenses:
- Focuses attack on north gate (fire arrows + battering ram)
- Enemy already demoralized from raiding party success
- Siege duration: 5 days (vs 10-15 days without sub-band intel)
- **Victory**: Castle captured, Count Valen surrenders

**Post-Battle Analysis:**
Sub-bands reduced siege time by 50%, saved 200 soldier lives (fewer casualties due to intel), cost: 4 raiders killed. **Net benefit: +196 soldiers saved, +40% time saved.**

---

## ECS Integration (Aggregate Pillar, 0.2 Hz)

### Components

```csharp
public struct AggregateEntity : IComponentData
{
    public Entity EntityId;
    public int MemberCount;
    public FixedList128Bytes<Entity> SubBands;  // Active sub-bands
    public int MaxSimultaneousSubBands;         // 3-8 depending on organization
}

public struct SubBand : IComponentData
{
    public Entity SubBandId;
    public Entity ParentBandId;
    public SubBandType Type;                     // Scout, Foraging, Resupply, etc.
    public int MemberCount;
    public FixedList64Bytes<Entity> Members;
    public float AutonomyLevel;                  // 0-1 (Tethered, Semi, Independent)
    public float3 TargetLocation;
    public float MaxRangeFromParent;             // km
    public float MissionDuration;                // days
    public float TimeElapsed;                    // days
    public bool MissionComplete;
    public bool HasRejoined;
}

public struct SubBandMission : IComponentData
{
    public Entity SubBandId;
    public MissionObjective Objective;           // Scout, Forage, Resupply, etc.
    public FixedList64Bytes<float> ObjectiveProgress;  // % complete for each sub-objective
    public float SuccessProbability;             // 0-1
    public bool RequiresParentApproval;          // For tactical decisions
}

public struct SubBandResources : IComponentData
{
    public Entity SubBandId;
    public int FoodRations;
    public int Gold;
    public int Ammunition;
    public FixedList64Bytes<Item> Equipment;
    public float CargoCapacity;                  // kg
    public float CurrentCargo;                   // kg
}

public struct SubBandCommunication : IComponentData
{
    public Entity SubBandId;
    public Entity ParentBandId;
    public CommunicationMethod Method;           // Messenger, Signal, Magic, Pigeon
    public float LastContactTime;                // hours ago
    public float NextReportDue;                  // hours
    public bool ContactLost;                     // If overdue by 2× report interval
}

public struct RendezvousPoint : IComponentData
{
    public Entity SubBandId;
    public float3 Location;
    public float ScheduledTime;                  // Game time when rendezvous occurs
    public float WaitDuration;                   // How long parent waits (hours)
    public bool IsFixed;                         // Fixed location vs mobile tracking
}

public struct SubBandCasualties : IComponentData
{
    public Entity SubBandId;
    public int MembersKilled;
    public int MembersWounded;
    public int MembersDeserted;
    public int MembersCaptured;
    public float CasualtyRate;                   // 0-1
}
```

---

### Systems

**SubBandFormationSystem** (0.2 Hz):
```csharp
public partial struct SubBandFormationSystem : ISystem
{
    public void OnUpdate(ref SystemState state)
    {
        foreach (var aggregate in SystemAPI.Query<RefRW<AggregateEntity>>())
        {
            // Check if needs sub-band
            bool needsScouts = EvaluateScoutingNeed(aggregate.ValueRO);
            bool needsForaging = EvaluateForagingNeed(aggregate.ValueRO);
            bool needsResupply = EvaluateResupplyNeed(aggregate.ValueRO);

            if (needsScouts && CanFormSubBand(aggregate.ValueRO, SubBandType.Scout))
            {
                Entity subBand = CreateSubBand(
                    aggregate.ValueRO.EntityId,
                    SubBandType.Scout,
                    memberCount: 6,
                    duration: 3f,  // days
                    range: 15f  // km
                );

                aggregate.ValueRW.SubBands.Add(subBand);
            }

            // Similar for other sub-band types...
        }
    }

    private bool EvaluateScoutingNeed(AggregateEntity aggregate)
    {
        float unexploredPercent = GetUnexploredTerrainPercent(aggregate.EntityId);
        float enemyProximity = GetEnemyProximityRisk(aggregate.EntityId);
        float mapQuality = GetMapQuality(aggregate.EntityId);

        float need = unexploredPercent + enemyProximity - mapQuality;
        return need > 60f;
    }
}
```

**SubBandMissionSystem** (0.2 Hz):
```csharp
public partial struct SubBandMissionSystem : ISystem
{
    public void OnUpdate(ref SystemState state)
    {
        float deltaTime = SystemAPI.Time.DeltaTime;

        foreach (var (subBand, mission) in SystemAPI.Query<RefRW<SubBand>, RefRW<SubBandMission>>())
        {
            subBand.ValueRW.TimeElapsed += deltaTime / 86400f;  // Convert to days

            // Update mission progress
            UpdateMissionProgress(ref mission.ValueRW, subBand.ValueRO.Type, deltaTime);

            // Check if mission complete
            if (IsMissionComplete(mission.ValueRO))
            {
                subBand.ValueRW.MissionComplete = true;
                InitiateRejoinSequence(subBand.ValueRO.SubBandId);
            }

            // Check if mission failed (time exceeded, casualties too high)
            if (subBand.ValueRO.TimeElapsed > subBand.ValueRO.MissionDuration * 1.5f)
            {
                HandleMissionFailure(subBand.ValueRO.SubBandId);
            }
        }
    }
}
```

**SubBandCommunicationSystem** (0.2 Hz):
```csharp
public partial struct SubBandCommunicationSystem : ISystem
{
    public void OnUpdate(ref SystemState state)
    {
        float deltaTime = SystemAPI.Time.DeltaTime / 3600f;  // Convert to hours

        foreach (var comm in SystemAPI.Query<RefRW<SubBandCommunication>>())
        {
            comm.ValueRW.LastContactTime += deltaTime;

            if (comm.ValueRW.LastContactTime >= comm.ValueRW.NextReportDue)
            {
                // Attempt communication
                bool success = AttemptCommunication(comm.ValueRO.Method, comm.ValueRO.SubBandId);

                if (success)
                {
                    comm.ValueRW.LastContactTime = 0f;
                    comm.ValueRW.NextReportDue = GetNextReportInterval(comm.ValueRO.SubBandId);
                    comm.ValueRW.ContactLost = false;
                }
                else
                {
                    // Communication failed
                    if (comm.ValueRW.LastContactTime > comm.ValueRW.NextReportDue * 2f)
                    {
                        comm.ValueRW.ContactLost = true;
                        NotifyParentOfContactLoss(comm.ValueRO.ParentBandId, comm.ValueRO.SubBandId);
                    }
                }
            }
        }
    }
}
```

**SubBandRejoiningSystem** (0.2 Hz):
```csharp
public partial struct SubBandRejoiningSystem : ISystem
{
    public void OnUpdate(ref SystemState state)
    {
        foreach (var (subBand, rendezvous) in SystemAPI.Query<RefRW<SubBand>, RefRO<RendezvousPoint>>())
        {
            if (!subBand.ValueRO.MissionComplete || subBand.ValueRO.HasRejoined)
                continue;

            float currentTime = GetGameTime();

            if (currentTime >= rendezvous.ValueRO.ScheduledTime)
            {
                // Attempt rendezvous
                bool success = AttemptRendezvous(subBand.ValueRO, rendezvous.ValueRO);

                if (success)
                {
                    ReintegrateSubBand(subBand.ValueRW);
                }
                else if (currentTime > rendezvous.ValueRO.ScheduledTime + rendezvous.ValueRO.WaitDuration)
                {
                    // Parent gave up waiting
                    HandleAbandonedSubBand(subBand.ValueRW);
                }
            }
        }
    }

    private void ReintegrateSubBand(RefRW<SubBand> subBand)
    {
        // Transfer resources back to parent
        TransferResources(subBand.ValueRO.SubBandId, subBand.ValueRO.ParentBandId);

        // Transfer intelligence
        TransferIntel(subBand.ValueRO.SubBandId, subBand.ValueRO.ParentBandId);

        // Reintegrate members
        TransferMembers(subBand.ValueRO.SubBandId, subBand.ValueRO.ParentBandId);

        // Apply morale effects
        ApplyRejoiningMorale(subBand.ValueRO.ParentBandId, subBand.ValueRO);

        subBand.ValueRW.HasRejoined = true;
    }
}
```

---

## Conclusion

The sub-band system enables large aggregate entities to operate efficiently across multiple theaters simultaneously. By temporarily splitting specialized detachments for scouting, foraging, resupply, raiding, diplomacy, and rear-guard actions, parent bands can extend their operational range, gather critical intelligence, and accomplish objectives impossible for the main force. Successful sub-band management—balancing autonomy with control, risk with reward, and coordination with independence—separates masterful commanders from mediocre ones.
